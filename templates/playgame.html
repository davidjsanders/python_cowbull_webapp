{% extends "base_template.html" %}
{% block title %}CowBull SPA{% endblock %}

{% block header %}
    <script type="text/javascript">
        /* Define globals */
        g_digits = {{digits}};
        g_guesses = {{guesses}};
        g_try = 0;
        g_key = "{{key}}";
    </script>
<!--    <script src="{{ url_for('static', filename='js/validateDigit.js') }}?v=0.4"></script> -->
    <script src="{{ url_for('static', filename='js/makeGuess.js') }}?v=0.12"></script>
{% endblock %}

{% block game %}
<div id="game" class="game_on">
    <p>
        <span id="play_status">
            You have {{guesses}} guesses remaining. Please make your first guess.
        </span>
    </p>
    <form>
        &nbsp;
        {% for i in range(digits) %}
            <input id="digit_{{i}}"
                   class="digit"
                   required="required"
                   name="digit_{{i}}_name"
                   type="text"
                   width="2"
                   value="{{i}}"
                   onblur="validateDigit(this);"
            > &nbsp;
        {% endfor %}
        <script type="text/javascript">
            for (i = 0; i < g_guesses; i++) {
                var digit = document.getElementById('digit_'+i);
    /*            digit.addEventListener("blur", validateDigit); */
            }
        </script>
        <input type="button"
               class="btn-primary"
               value="Make a guess"
               onclick="makeGuess();"
        >
        &nbsp;
        <span id="error_status"></span>
    </form>
    <hr>
    <table class="table">
        <thead>
            <tr class="digit_row">
                <th class="digit_output">Try</th>
                {% for i in range(digits) %}
                    {% set header = i + 1 %}
                    <th class="digit_output">Digit {{header}}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for i in range(guesses) %}
                {% set row = i + 1 %}
                <tr class="digit_row">
                    <td class="digit_output">{{row}}</td>
                    {% for j in range(digits) %}
                        <td class="digit_output">
                            <span class="placeholder" id="row_{{i}}_col_{{j}}">&nbsp;&nbsp;</span>
                        </td>
                    {% endfor %}
                    <td>&nbsp</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block instructions %}
<table class="instruction_table">
    <tr>
        <td class="col1">Guesses</td>
        <td class="col2">{{guesses}}</td>
    </tr>
    <tr>
        <td class="col1">Digits</td>
        <td class="col2">{{digits}}</td>
    </tr>
    <tr>
        <td class="col1">Server</td>
        <td class="col2">{{served_by}}</td>
    </tr>
    <tr>
        <td class="col1">Key</td>
        <td class="col2">{{key}}</td>
    </tr>
</table>
<p>
    You need to guess the correct digits by entering your numbers
    and then choosing 'Make a guess'. Your guesses will then be
    highlighted as follows:
</p>
<table class="key_table">
    <tr>
        <td class="col1 miss bull">Bull</td>
        <td class="col2">Correct, in the right place</td>
    </tr>
    <tr>
        <td class="col1 miss cow">Cow</td>
        <td class="col2">Correct, but in the <em>wrong</em> place</td>
    </tr>
    <tr>
        <td class="col1 miss">Miss</td>
        <td class="col2">Incorrect</td>
    </tr>
</table>
<table class="key_table">
    <tr>
        <td class="col1 miss bull multiple">Bull</td>
        <td class="col2">Bull (more than one)</td>
    </tr>
</table>
<table class="key_table">
    <tr>
        <td class="col1 miss cow multiple">Cow</td>
        <td class="col2">Cow (more than one)</td>
    </tr>
</table>
{% endblock%}

{% block footer %}
<p><strong>CowBull version 0.1</strong></p>
{% endblock %}
